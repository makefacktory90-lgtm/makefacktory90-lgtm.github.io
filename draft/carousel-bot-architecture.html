<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carousel Bot -- Техническая спецификация</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Inter', sans-serif;
    background: #fff;
    color: #1a1a1a;
    line-height: 1.7;
    padding: 60px 40px;
    max-width: 940px;
    margin: 0 auto;
  }
  h1 { font-size: 2.4rem; font-weight: 800; letter-spacing: -0.03em; margin-bottom: 8px; }
  .subtitle { font-size: 1.1rem; color: #666; margin-bottom: 48px; font-weight: 400; }
  h2 { font-size: 1.5rem; font-weight: 700; margin-top: 56px; margin-bottom: 16px; letter-spacing: -0.02em; }
  h3 { font-size: 1.15rem; font-weight: 600; margin-top: 32px; margin-bottom: 12px; }
  p { margin-bottom: 16px; }

  .schema {
    background: #f8f8f8; border-radius: 16px; padding: 32px; margin: 32px 0;
    font-family: 'SF Mono', 'Fira Code', monospace; font-size: 0.82rem; line-height: 1.8;
    white-space: pre; overflow-x: auto;
  }
  .prompt-block {
    background: #fafafa; border-left: 4px solid #1a1a1a; border-radius: 0 12px 12px 0;
    padding: 24px 28px; margin: 20px 0; font-size: 0.92rem; line-height: 1.8;
  }
  .prompt-block .label {
    font-weight: 700; font-size: 0.78rem; text-transform: uppercase;
    letter-spacing: 0.08em; color: #999; margin-bottom: 12px;
  }
  .prompt-block code {
    display: block; white-space: pre-wrap; font-family: 'SF Mono', 'Fira Code', monospace;
    font-size: 0.85rem; color: #333;
  }
  .card {
    border: 1px solid #e0e0e0; border-radius: 12px; padding: 24px; margin: 16px 0;
  }
  .card h4 { font-size: 1rem; font-weight: 700; margin-bottom: 8px; }
  .card .tag {
    display: inline-block; background: #1a1a1a; color: #fff; font-size: 0.72rem;
    font-weight: 600; padding: 3px 10px; border-radius: 20px;
    text-transform: uppercase; letter-spacing: 0.06em; margin-bottom: 12px;
  }
  .card .tag.blue { background: #2563eb; }
  .card .tag.green { background: #16a34a; }
  .card .tag.orange { background: #ea580c; }
  .card .tag.purple { background: #7c3aed; }
  .card .tag.red { background: #dc2626; }
  .card .tag.yellow { background: #ca8a04; }

  .steps { counter-reset: step; list-style: none; padding: 0; }
  .steps li {
    counter-increment: step; padding: 16px 0 16px 56px; position: relative;
    border-bottom: 1px solid #f0f0f0;
  }
  .steps li:last-child { border-bottom: none; }
  .steps li::before {
    content: counter(step); position: absolute; left: 0; top: 16px;
    width: 36px; height: 36px; background: #1a1a1a; color: #fff; border-radius: 50%;
    display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85rem;
  }
  .steps li strong { font-weight: 600; }

  .highlight { background: #fffbe6; border-radius: 12px; padding: 20px 24px; margin: 24px 0; font-size: 0.92rem; }
  .highlight.pink { background: #fef2f2; }
  .highlight.blue { background: #eff6ff; }
  .highlight.green { background: #f0fdf4; }
  .highlight.purple { background: #f5f3ff; }

  .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 24px 0; }
  .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin: 24px 0; }
  .grid-item { background: #f8f8f8; border-radius: 12px; padding: 20px; }
  .grid-item h4 { font-size: 0.95rem; font-weight: 700; margin-bottom: 6px; }
  .grid-item p { font-size: 0.85rem; color: #555; margin-bottom: 0; }

  .phase {
    border: 2px solid #e0e0e0; border-radius: 16px; padding: 28px; margin: 24px 0; position: relative;
  }
  .phase .phase-num {
    position: absolute; top: -14px; left: 24px; background: #1a1a1a; color: #fff;
    font-size: 0.75rem; font-weight: 700; padding: 4px 14px; border-radius: 20px;
    text-transform: uppercase; letter-spacing: 0.06em;
  }
  .phase h3 { margin-top: 8px; }

  table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 0.88rem; }
  th { text-align: left; padding: 12px 16px; background: #f8f8f8; font-weight: 600; border-bottom: 2px solid #e0e0e0; }
  td { padding: 12px 16px; border-bottom: 1px solid #f0f0f0; vertical-align: top; }

  hr { border: none; border-top: 1px solid #eee; margin: 48px 0; }
  .footer { margin-top: 64px; padding-top: 24px; border-top: 1px solid #eee; font-size: 0.82rem; color: #999; }

  @media (max-width: 768px) {
    body { padding: 24px 16px; }
    h1 { font-size: 1.6rem; }
    .grid-2, .grid-3 { grid-template-columns: 1fr; }
    .schema { font-size: 0.72rem; padding: 16px; }
  }
</style>
</head>
<body>

<h1>Carousel Bot</h1>
<p class="subtitle">Telegram-бот: Instagram-карусели по маркетинговым формулам<br>Техническая спецификация для сборки на AIFromSpace</p>

<hr>

<h2>Что делает</h2>
<p>Пользователь приходит в Telegram. Отвечает на 4 вопроса. Через 30 секунд получает готовую карусель: текст по маркетинговой формуле + AI-картинки + подпись. Скачал и постишь.</p>

<p>16 маркетинговых формул. Автоподбор под цель. Тренды ниши. Адаптация под голос. Встроенный контроль качества. Карусели, которые получают сохранения.</p>

<hr>

<h2>Flow</h2>

<div class="schema">
ПЕРВЫЙ РАЗ                             ПОВТОРНЫЙ ВИЗИТ
    |                                       |
    v                                       v
Онбординг                            Weekly Push (вторник):
  4 вопроса (кнопки)                  "3 темы в твоей нише"
  + визуальные референсы                    |
  ~3 минуты                                 v
    |                                  Выбирает тему (1 тап)
    v                                       |
Профиль сохранён                            v
    |                               ИЛИ: "У меня есть тема"
    ---|-------------------------------|----
                    |
                    v
            АГЕНТ 1: Тема
              Адаптация под профиль
                    |
                    v
            АГЕНТ 2: Визуальная метафора
              Сквозная концепция
                    |
                    v
            АГЕНТ 3: Текст карусели
              Формула + профиль + правила
                    |
                    v
            АГЕНТ 4: Голос
              Переписать в тоне пользователя
                    |
                    v
            АГЕНТ 5: Скользкая горка
              Аудит каждого слайда
              (если слабо -- перегенер)
                    |
                    v
            АГЕНТ 6: CTA
              Оптимальный призыв
                    |
                    v
            АГЕНТ 7: Промты для картинок
              Nano Banana / ImageGen
                    |
                    v
            РЕЗУЛЬТАТ
              Текст + картинки + подпись
              + "Формула: PAS"
                    |
                    v
            [Скачать] [Поправить]
                    |
                    v
            Через 48ч: "Как результат?"</div>

<p><strong>Пользователь видит:</strong> тему, результат, кнопки. Всё остальное -- под капотом. Один вариант, не три. Формула подбирается автоматически.</p>

<hr>

<h2>Pipeline: 7 агентов под капотом</h2>
<p>Каждый агент -- отдельный вызов через AskAssistantTool или CallLLMTool. Пользователь не видит промежуточные шаги. Весь pipeline за 20-40 секунд.</p>

<!-- АГЕНТ 1: ТЕМА -->
<div class="phase">
  <div class="phase-num">Агент 1</div>
  <h3>Тема: weekly push или своя</h3>

  <p><strong>Путь A: Weekly Push.</strong> Вторник, 10:00. Бот сам приходит с 3 темами.</p>

  <div class="prompt-block">
    <div class="label">Промт: weekly push (3 темы)</div>
    <code>Ты -- контент-стратег.

ПРОФИЛЬ:
- Ниша: {niche}
- ЦА: {audience}, боли: {pains}, желания: {desires}
- Цель: {goal}
- Tone of voice: {tone_of_voice}
- Продукт: {product}
- Формулы, которые уже использовал: {formulas_used}

ЗАДАЧА:
Сгенерируй 3 темы для каруселей на этой неделе:
- 1 тема на боль (цепляет за проблему)
- 1 тема на пользу (хочется сохранить)
- 1 тема на прогрев (мягкая продажа)

Для каждой:
- Хук (первый слайд, max 8 слов)
- Почему зацепит эту ЦА (1 предложение)
- Формула, которую бот применит (из неиспользованных недавно)

Правила:
- Не повторять темы прошлых 4 недель
- Конкретно ("Читинг -- не срыв" вместо "про питание")

3 темы. Коротко. Без воды.</code>
  </div>

  <p><strong>Путь B: Своя тема.</strong> Пользователь пишет тему. Бот адаптирует под профиль.</p>

  <div class="prompt-block">
    <div class="label">Промт: адаптация своей темы</div>
    <code>Пользователь хочет карусель на тему: "{user_topic}"

ПРОФИЛЬ:
- Ниша: {niche}, ЦА: {audience}, ToV: {tone_of_voice}, Цель: {goal}

ЗАДАЧА:
1. Сформулируй тему как заголовок карусели (max 8 слов, в стиле пользователя)
2. Подбери формулу (из неиспользованных недавно, под цель)
3. Определи количество слайдов (5-10)

Не спрашивай уточнений -- прими лучшее решение.
Выдай: заголовок + формула + кол-во слайдов.</code>
  </div>

  <h3>Автоподбор формулы</h3>
  <table>
    <tr><th>Цель (из профиля)</th><th>Основная формула</th><th>Ротация</th></tr>
    <tr><td>Продажи</td><td>PAS</td><td>BAB, AIDA, Case Study, Social Proof, FAB</td></tr>
    <tr><td>Охваты</td><td>Контраст</td><td>Open Loop, Провокация, Cliff, Countdown</td></tr>
    <tr><td>Экспертность</td><td>Скользкая горка</td><td>How-To, Пирамида, Q&A</td></tr>
    <tr><td>Подписки</td><td>Сторителлинг</td><td>Cliff, Open Loop</td></tr>
    <tr><td>Запуск продукта</td><td>AIDA</td><td>FAB, Countdown</td></tr>
  </table>
  <p>Ротация: не повторять последние 3 использованные формулы.</p>
</div>

<!-- АГЕНТ 2: ВИЗУАЛЬНАЯ МЕТАФОРА -->
<div class="phase">
  <div class="phase-num">Агент 2</div>
  <h3>Визуальная метафора</h3>

  <div class="prompt-block">
    <div class="label">Промт: сквозная визуальная концепция</div>
    <code>Ты -- Креативный Директор мирового уровня и мастер визуальных метафор.
Стиль: минимализм, умный дизайн, неочевидные ассоциации.

ЗАДАЧА:
Преврати тему в концепцию для Instagram-карусели, основанную на ОДНОЙ сквозной визуальной метафоре. Никаких банальностей.

ВВОДНЫЕ:
- Ниша: {niche}
- Тема: {topic}
- Главная мысль: {main_idea}
- Визуальный стиль: {visual_style}

ЧТО СДЕЛАТЬ:
1. Предложи 1 лучшую визуальную метафору (не 3 -- одну).
2. Распиши покадровый план для {slide_count} слайдов.

Для каждого слайда:
- Что изображено (объект)
- Как связано с темой (смысл)
- Настроение / атмосфера

Выдай план. Без воды.</code>
  </div>
</div>

<!-- АГЕНТ 3: ТЕКСТ -->
<div class="phase">
  <div class="phase-num">Агент 3</div>
  <h3>Текст карусели</h3>

  <div class="prompt-block">
    <div class="label">Промт: генерация текста</div>
    <code>Ты -- Главный Редактор вирального медиа. Ты ненавидишь "воду" и банальности.
Задача -- создать сценарий Instagram-карусели, которую невозможно пролистнуть.

ВВОДНЫЕ:
- Тема: {topic}
- Угол: {angle}
- Цель: {goal}
- Формула: {formula_name}
- Количество слайдов: {slide_count}
- Визуальная метафора: {visual_concept}

ПРАВИЛА ФОРМУЛЫ "{formula_name}":
{formula_rules}

ПРОФИЛЬ АВТОРА:
- Ниша: {niche}
- Аудитория: {audience}
- Tone of voice: {tone_of_voice}

СТРОГИЕ ТРЕБОВАНИЯ К СТИЛЮ:
- Плотность: 1 слайд = 1 законченная мысль. Никаких лишних слов
- Полярность: спорно, любопытно или ломает стереотипы
- ЗАГОЛОВОК: строго до 40 символов (жирно)
- ТЕКСТ: строго до 160 символов (1-3 предложения)
- Каждый слайд заканчивается так, что хочется листнуть
- ЗАПРЕЩЕНО: "в современном мире", "каждый из нас", "не секрет что",
  "давайте разберёмся", "простыми словами", "важно понимать",
  "уникальный", "качественный", "является"

ПЛАТФОРМЕННЫЕ ПРАВИЛА:
{platform_rules}

СТРУКТУРА:
- Слайд 1: HOOK. Удар по боли или провокация. Max 8 слов
- Слайды 2-N: КОНТЕНТ по формуле. 1 мысль = 1 слайд. 15-40 слов
- Последний: CTA ("сохрани" > "подпишись" для алгоритма)

ВЫХОД:
- Все слайды: номер + подзаголовок (жирный, 2-5 слов) + текст
- Подпись под карусель (150-300 слов, с хештегами)
- Укажи: "Формула: {formula_name}"

=== ПРИМЕР ===

Тема: Читинг. Ниша: нутрициология. ToV: тепло, на ты.
Формула: PAS. Цель: продажи.

"Формула: PAS (Боль > Усиление > Решение)"

[1] HOOK
Ты не сорвалась. Ты поела.

[2] БОЛЬ
**Знакомое чувство?**
Вечер. Холодильник. "Только один кусочек."
А потом стыд. Вина. "С понедельника точно..."

[3] БОЛЬ+
**Калькулятор в голове**
Ты считаешь каждый грамм. Банан -- 90 ккал.
Шоколадка -- всё, день провален.

[4] УСИЛЕНИЕ
**Тебе 30. Ты считаешь еду как бухгалтер.**
И чувствуешь себя виноватой за ужин. Виноватой. За ужин.

[5] УСИЛЕНИЕ+
**А коллега ест пасту и не толстеет.**
У неё не метаболизм. У неё нет калькулятора в голове.

[6] ПОВОРОТ
**Я работаю с РПП 5 лет.**
Проблема не в еде. Проблема в том,
что тебя научили бояться еды.

[7] РЕШЕНИЕ
**Интуитивное питание -- не про "ешь что хочешь".**
Система: 4 маркера. Когда знаешь их -- калькулятор выключается.

[8] PROOF
**Маша, 34 года.**
"За 2 месяца перестала считать. Похудела на 4 кг.
Не диета -- перестала заедать стресс."

[9] КАК
**Один воркшоп. 2 часа. 4 маркера голода.**
Без диет, без подсчётов, без вины.

[10] CTA
**Воркшоп "Еда без вины" -- 14 марта.**
Напиши ЕДА в директ. Мест 20.

=== КОНЕЦ ПРИМЕРА ===</code>
  </div>
</div>

<!-- АГЕНТ 4: ГОЛОС -->
<div class="phase">
  <div class="phase-num">Агент 4</div>
  <h3>Адаптация голоса</h3>

  <div class="prompt-block">
    <div class="label">Промт: переписать в тоне пользователя</div>
    <code>Ты -- редактор, который превращает сухие тексты в живую речь.

ПРОФИЛЬ АВТОРА:
- Кто: {niche}, {expertise}
- ЦА: {audience}
- Голос: {tone_of_voice}
- Запретные слова: {banned_words}

ТЕКСТ КАРУСЕЛИ:
{carousel_text}

ЗАДАЧА:
Перепиши так, чтобы:
- Звучало как автор говорит подруге за кофе
- Каждый слайд -- максимум 15 слов заголовок, 160 символов текст
- Убрана вода, оставлено мясо
- Сохранён стиль автора
- Структура формулы НЕ нарушена

Один вариант. В тоне "{tone_of_voice}".
Выдай полный текст всех слайдов.</code>
  </div>
</div>

<!-- АГЕНТ 5: СКОЛЬЗКАЯ ГОРКА -->
<div class="phase">
  <div class="phase-num">Агент 5</div>
  <h3>Скользкая горка (невидимый критик)</h3>
  <p>Пользователь НЕ видит этот шаг. Если оценка &lt; 7/10 -- автоматический перегенер через Агента 3.</p>

  <div class="prompt-block">
    <div class="label">Промт: аудит "скользкая горка"</div>
    <code>Ты -- копирайтер уровня Шугермана + архитектор внимания.
500+ каруселей за карьеру.

Задача: превратить карусель в "скользкую горку" --
чтобы человек физически не мог остановиться.

ПРИНЦИП: Каждый слайд = незавершённый гештальт.
Мозг ОБЯЗАН листать дальше.

ТЕКСТ КАРУСЕЛИ:
{carousel_text}

Формула: {formula_name}
Профиль: ниша={niche}, тон={tone_of_voice}, ЦА={audience}
Цель: {goal}

СДЕЛАЙ:

1. АУДИТ ДЫРЫ
Найди места, где человек может уйти.

2. ПЕРЕХОДНЫЕ КРЮЧКИ
Для каждого слайда -- "мост" в следующий:
- Незаконченная мысль ("Но это не главное...")
- Открытый вопрос ("А что если...?")
- Обещание ("Дальше -- то, что изменит всё")
- Конфликт ("Но тут я облажалась")

3. ЧЕКЛИСТ (оцени 1-10):
- HOOK: остановит скролл? Max 8 слов?
- КАЖДЫЙ СЛАЙД: хочется листнуть? 1 мысль? 15-40 слов?
- ФОРМУЛА: структура соответствует?
- CTA: одно действие? "Сохрани" > "подпишись"?
- TONE OF VOICE: соответствует профилю?
- АНТИБАНАЛЬНОСТЬ: стоп-слова?
- ВИРУСНОСТЬ: захочется переслать?
- ПРОВЕРКА "3 СЕКУНДЫ": каждый слайд --
  увидит на 3 секунды -- листнёт? Если нет -- переделай.

Общая оценка: X/10

Если X < 7: выдай исправленную версию всех слайдов.
Если X >= 7: "ОК"

Формат: оценка + таблица
| Слайд | Было | Стало | Крючок | Сила тяги 1-10 |</code>
  </div>
</div>

<!-- АГЕНТ 6: CTA -->
<div class="phase">
  <div class="phase-num">Агент 6</div>
  <h3>CTA-оптимизатор</h3>

  <div class="prompt-block">
    <div class="label">Промт: оптимальный призыв к действию</div>
    <code>Ты -- копирайтер. Огилви завидовал бы. Твои CTA не впаривают, а приглашают.

ПРОФИЛЬ: {niche}, ЦА: {audience}
ЦЕЛЬ КАРУСЕЛИ: {goal}
ТЕКСТ КАРУСЕЛИ: {carousel_text}

ЗАДАЧА:
Напиши лучший последний слайд. Один вариант.
Выбери подход под цель:

- Продажи: конкретный (с цифрой или дедлайном)
- Охваты: вопросом (вовлекает в коммент)
- Экспертность: мягкий (без давления, "сохрани")
- Подписки: социальное доказательство
- Запуск: с дедлайном и ограничением

Правило: "сохрани" работает лучше "подпишись" для алгоритма.

Выдай: текст последнего слайда + почему этот подход.</code>
  </div>
</div>

<!-- АГЕНТ 7: КАРТИНКИ -->
<div class="phase">
  <div class="phase-num">Агент 7</div>
  <h3>Промты для картинок</h3>

  <p>Два режима по тарифу: Standard (картинки без текста) и Pro (текст на картинке).</p>

  <div class="prompt-block">
    <div class="label">Промт: генерация промта для ImageGen</div>
    <code>Ты -- промт-инженер для модели генерации изображений.

ЗАДАЧА: Сгенерируй промт для одного слайда карусели.

ВВОДНЫЕ:
- Номер слайда: {slide_num} из {total_slides}
- Тип слайда: {slide_type} (hook / content / cta)
- Текст на слайде: "{slide_text}"
- Подзаголовок: "{slide_subtitle}"
- Визуальный стиль: {visual_style}
- Визуальная метафора: {visual_concept}
- Цвета бренда: {brand_colors}
- Style DNA: {style_dna}

РЕЖИМ: {mode} (standard / pro)

Если standard:
- Фон/композиция/настроение. Текст НЕ на картинке.

Если pro:
- Текст прямо на картинке
- CONTENT LOCK: текст должен остаться exactly as written.
  Do not rewrite, paraphrase, enhance, or correct it.

ТРЕБОВАНИЯ:
- Формат: 1080x1350 (4:5)
- Стиль единый для всех слайдов (первый = якорь)
- Текст читаемый (контраст, размер)
- Фон не конфликтует с текстом

Выдай готовый промт. Один. Без комментариев.</code>
  </div>
</div>

<hr>

<h2>Онбординг</h2>
<p>Один раз. 5 шагов. Кнопки где можно, свободный текст где нужно. ~3 минуты.</p>

<table>
  <tr><th>#</th><th>Вопрос</th><th>Зачем</th><th>Формат</th></tr>
  <tr><td>1</td><td>Как зовут? Чем занимаешься?</td><td>Ниша, экспертиза</td><td>Свободный текст</td></tr>
  <tr><td>2</td><td>Кто твои клиенты? Что у них болит?</td><td>ЦА + боли + желания</td><td>Свободный текст</td></tr>
  <tr><td>3</td><td>Цель Instagram + как общаешься?</td><td>Стратегия + ToV</td><td>Кнопки: Продажи / Экспертность / Охваты + Дерзко / Тепло / Экспертно</td></tr>
  <tr><td>4</td><td>Визуальный стиль?</td><td>Стиль карусели</td><td>Кнопки + превью: 6 стилей</td></tr>
  <tr><td>5</td><td>Загрузи 1-3 картинки, которые нравятся</td><td>Style DNA</td><td>Фото / скриншоты</td></tr>
</table>

<p><strong>Прогресс-бар:</strong> "2 из 5" на каждом шаге. Финальное подтверждение: "Маша, нутрициолог. ЦА: женщины 30+. Тон: тепло. Стиль: минимализм. Верно?"</p>

<h3>Style DNA: извлечение визуального стиля из референсов</h3>

<div class="prompt-block">
  <div class="label">Промт: Style DNA (вшит в онбординг, шаг 5)</div>
  <code>You are an art director with 15 years of experience in fashion and advertising.

Analyze the uploaded image(s). Extract the visual DNA.

COLOR:
- Main palette (3-4 colors, hex codes)
- Warm/cold, High contrast or muted, Accent color

LIGHT:
- Direction (side, top, back, diffused)
- Soft or hard, Natural or studio
- Shadow type and intensity

COMPOSITION:
- Focal point, Symmetry or asymmetry
- Negative space, Object placement

TEXTURE:
- Smooth or grainy, Matte or glossy, Film effect

MOOD:
- What emotion does it evoke
- One word to describe it: ______

OUTPUT IN 2 FORMATS:
1. RECIPE FOR SERIES (copy to every new prompt)
2. ONE-LINE TAGS (comma-separated, English)

Save as style_dna in user profile.</code>
</div>

<h3>Профиль пользователя</h3>

<div class="prompt-block">
  <div class="label">Структура профиля (ManageConstantMemoryTool)</div>
  <code>{
  "user_id": 123456,
  "name": "Маша",
  "niche": "нутрициология",
  "expertise": "интуитивное питание, РПП",
  "product": "воркшоп 'Еда без вины'",
  "audience": "женщины 28-40, устали от диет",
  "pains": ["считают калории", "чувство вины за еду", "срывы"],
  "desires": ["есть спокойно", "похудеть без диет"],
  "goal": "продажи",
  "tone_of_voice": "на ты, тёплый но прямой, с юмором",
  "banned_words": ["уникальный", "качественный"],
  "visual_style": "minimal_light",
  "brand_colors": {"primary": "#1a1a1a", "accent": "#e85d3a"},
  "style_dna": "warm, soft light, matte, minimal, earthy tones",
  "plan": "starter",
  "carousels_made": 0,
  "streak": 0,
  "formulas_used": [],
  "last_carousel_date": null,
  "topics_history": []
}</code>
</div>

<div class="highlight blue">
<strong>Lock-in:</strong> Чем больше пользуется, тем точнее бот знает стиль. Уйти к конкуренту = заново объяснять кто ты. Профиль = привязка.
</div>

<hr>

<h2>Визуальные стили (онбординг, шаг 4)</h2>

<div class="grid-3">
  <div class="grid-item"><h4>Clean Light</h4><p>Белый, чёрный текст, минимализм. Эксперты, коучи.</p></div>
  <div class="grid-item"><h4>Bold Dark</h4><p>Чёрный фон, акцентный текст. Бизнес, tech.</p></div>
  <div class="grid-item"><h4>Magazine</h4><p>Журнальная вёрстка. Лайфстайл, фешн.</p></div>
  <div class="grid-item"><h4>Gradient Pop</h4><p>Яркие градиенты, округлые формы. Креативщики.</p></div>
  <div class="grid-item"><h4>Soft Pastel</h4><p>Пастельные тона, мягкость. Психологи, women-бренды.</p></div>
  <div class="grid-item"><h4>Editorial</h4><p>Газетный стиль, serif, контраст. Писатели, журналисты.</p></div>
</div>

<p>Standard (Starter): AI-картинки без текста. Pro: картинки с русским текстом на слайде.</p>

<hr>

<h2>Retention Engine</h2>
<p>Три механизма, которые превращают разовое использование в привычку.</p>

<div class="phase">
  <div class="phase-num">1</div>
  <h3>Weekly Push: бот приходит сам</h3>
  <p><strong>Вторник, 10:00.</strong> 3 темы. Тап -- карусель за 30 сек.</p>
  <p><strong>Четверг, 10:00.</strong> Если не зашёл: "Тема #1 набирает обороты. Карусель за 2 минуты?"</p>
  <p>Одно напоминание в неделю, не больше. Только платные тарифы.</p>
</div>

<div class="phase">
  <div class="phase-num">2</div>
  <h3>Обратная связь: 48 часов после карусели</h3>

  <div class="schema">
БОТ:
  "Маша, как карусель про читинг?
   [50+ сохранений]
   [10-50]
   [Меньше 10]
   [Не постила ещё]"</div>

  <p>Обогащает профиль: бот узнаёт, какие формулы работают. Возвращает в бот. "Круто" -- предложить поделиться. "Плохо" -- предложить другую формулу.</p>
</div>

<div class="phase">
  <div class="phase-num">3</div>
  <h3>Streak + прогресс</h3>

  <div class="schema">
После каждой карусели:
  "Карусель #7. Формула: Контраст.
   Ты использовала 5 из 16 формул.
   Серия: 3 недели подряд."

После 10 каруселей:
  "10 каруселей! Ты освоила 6 формул.
   Как результаты? Хочешь поделиться?"
   --> автоматический сбор кейсов</div>
</div>

<hr>

<h2>Платформенный интеллект</h2>
<p>Вшит в промт генерации как контекст. Обновляется раз в 2 недели.</p>

<div class="prompt-block">
  <div class="label">База знаний: правила Instagram (обновляемая)</div>
  <code>INSTAGRAM ALGORITHM RULES (обновлено: {date})

ЧТО ПОЛУЧАЕТ PUSH:
- Карусели: алгоритм показывает непролистанную повторно (второй шанс)
- Сохранения > лайки > комментарии (по весу)
- Первые 30 мин критичны
- 7-10 слайдов лучше 3-5 (больше время просмотра)
- Текст на картинке повышает время остановки скролла

ЧТО ВИРУСИТСЯ:
- Контраст "ожидание vs реальность"
- Мини-гайды с конкретными шагами
- Провокационные первые слайды ("Не делай X")
- Данные/статистика в визуале

ЧТО УБИВАЕТ ОХВАТЫ:
- Внешние ссылки в тексте
- Стоковые визуалы (алгоритм распознаёт)
- Больше 1 карусели в день

ФОРМАТ:
- Первый слайд: max 8 слов, крупный шрифт
- Каждый слайд: 1 мысль
- CTA: "сохрани" > "подпишись"
- Подпись: 150-300 слов</code>
</div>

<hr>

<h2>16 формул</h2>
<p>Ядро продукта. Каждая: структура слайдов, правила переходов, пример, ошибки.</p>

<!-- ФОРМУЛА 1: PAS -->
<div class="card">
  <span class="tag red">Продажи</span>
  <h4>1. PAS -- Problem > Agitate > Solution</h4>
  <p>Классика прямых продаж. Давление через боль, усиление, спасение.</p>
  <table>
    <tr><td>1</td><td><strong>HOOK</strong></td><td>Провокационное утверждение. Max 8 слов.</td></tr>
    <tr><td>2</td><td><strong>PROBLEM</strong></td><td>Конкретная боль с деталями.</td></tr>
    <tr><td>3</td><td><strong>PROBLEM+</strong></td><td>Углубление: почему это больно.</td></tr>
    <tr><td>4</td><td><strong>AGITATE</strong></td><td>Последствия бездействия.</td></tr>
    <tr><td>5</td><td><strong>AGITATE+</strong></td><td>Эмоциональный пик.</td></tr>
    <tr><td>6</td><td><strong>PIVOT</strong></td><td>"Но есть кое-что, что работает." Интрига.</td></tr>
    <tr><td>7</td><td><strong>SOLUTION</strong></td><td>Решение: что именно. Конкретно.</td></tr>
    <tr><td>8</td><td><strong>PROOF</strong></td><td>Цифра, кейс, факт.</td></tr>
    <tr><td>9</td><td><strong>HOW</strong></td><td>Как получить решение.</td></tr>
    <tr><td>10</td><td><strong>CTA</strong></td><td>"Сохрани и попробуй."</td></tr>
  </table>
  <p><strong>Правила:</strong> Слайды 2-5 нарастают. Слайд 6 -- резкий слом. Решение не раньше 7.</p>
  <p><strong>Ошибки:</strong> Мягкая боль. Решение на слайде 3. CTA "подпишись" вместо "сохрани".</p>
</div>

<!-- ФОРМУЛА 2: BAB -->
<div class="card">
  <span class="tag red">Продажи</span>
  <h4>2. BAB -- Before > After > Bridge</h4>
  <table>
    <tr><td>1</td><td><strong>HOOK</strong></td><td>Контраст в одной фразе.</td></tr>
    <tr><td>2-3</td><td><strong>BEFORE</strong></td><td>Подробное "до": детали, эмоции, цифры.</td></tr>
    <tr><td>4</td><td><strong>TURNING</strong></td><td>Момент перелома.</td></tr>
    <tr><td>5-6</td><td><strong>AFTER</strong></td><td>"После": те же метрики, другие цифры.</td></tr>
    <tr><td>7-8</td><td><strong>BRIDGE</strong></td><td>Что изменилось. Max 3 шага.</td></tr>
    <tr><td>9</td><td><strong>TAKEAWAY</strong></td><td>Главный вывод.</td></tr>
    <tr><td>10</td><td><strong>CTA</strong></td><td>"Сохрани, если узнала себя в 'до'."</td></tr>
  </table>
  <p><strong>Правила:</strong> "До" болезненно конкретным. "После" реалистичный. Мост -- max 3 шага.</p>
</div>

<!-- ФОРМУЛА 3: AIDA -->
<div class="card">
  <span class="tag orange">Запуски</span>
  <h4>3. AIDA -- Attention > Interest > Desire > Action</h4>
  <table>
    <tr><td>1</td><td><strong>ATTENTION</strong></td><td>Шок, неожиданность, цифра.</td></tr>
    <tr><td>2-3</td><td><strong>INTEREST</strong></td><td>Почему важно именно тебе.</td></tr>
    <tr><td>4-5</td><td><strong>DESIRE</strong></td><td>Как будет. Сенсорные детали.</td></tr>
    <tr><td>6-7</td><td><strong>PROOF</strong></td><td>Соцдоказательство.</td></tr>
    <tr><td>8</td><td><strong>OFFER</strong></td><td>Что предлагается.</td></tr>
    <tr><td>9</td><td><strong>URGENCY</strong></td><td>Почему сейчас.</td></tr>
    <tr><td>10</td><td><strong>ACTION</strong></td><td>Одно действие.</td></tr>
  </table>
</div>

<!-- ФОРМУЛА 4: Скользкая горка -->
<div class="card">
  <span class="tag purple">Экспертность</span>
  <h4>4. Скользкая горка (Шугерман)</h4>
  <table>
    <tr><td>1</td><td><strong>HOOK</strong></td><td>Обещание + интрига.</td></tr>
    <tr><td>2</td><td><strong>SETUP</strong></td><td>Контекст. Обрыв.</td></tr>
    <tr><td>3-7</td><td><strong>SLIDE</strong></td><td>Каждый обрывается на полумысли.</td></tr>
    <tr><td>8-9</td><td><strong>PAYOFF</strong></td><td>Кульминация.</td></tr>
    <tr><td>10</td><td><strong>CTA</strong></td><td>"Сохрани -- перечитаешь."</td></tr>
  </table>
  <p><strong>Правила:</strong> КАЖДЫЙ слайд -- незавершённая мысль. Многоточие, "но...", вопрос.</p>
</div>

<!-- ФОРМУЛА 5-16: компактно -->
<div class="card">
  <span class="tag blue">Охваты</span>
  <h4>5. Open Loop -- Незакрытая петля</h4>
  <p>Обещание на первом слайде. Отдача на последнем. 1: PROMISE > 2-4: CONTEXT (не раскрывает) > 5-7: BUILD > 8-9: REVEAL > 10: CTA. Обещание ДОЛЖНО быть выполнено.</p>
</div>

<div class="card">
  <span class="tag blue">Охваты</span>
  <h4>6. Контраст -- Миф vs Реальность</h4>
  <p>1: HOOK ("5 вещей, которые врали") > 2-7: 3 пары Миф > Реальность (нарастают по остроте) > 8-9: ВЫВОД > 10: CTA ("Перешли подруге").</p>
</div>

<div class="card">
  <span class="tag purple">Подписки</span>
  <h4>7. Сторителлинг</h4>
  <p>1: IN MEDIAS RES > 2: BACKSTORY > 3-4: CHALLENGE > 5: ATTEMPT > 6: TURNING POINT > 7-8: ACTION > 9: RESULT (цифры) > 10: CTA. Обязательно in medias res. Детали: имена, цифры, места.</p>
</div>

<div class="card">
  <span class="tag purple">Экспертность</span>
  <h4>8. How-To / Listicle</h4>
  <p>1: HOOK (обещание с цифрой) > 2-9: по шагу на слайд (1 действие, можно за 15 мин) > 10: CTA ("Сохрани как чеклист").</p>
</div>

<div class="card">
  <span class="tag orange">Запуски</span>
  <h4>9. FAB -- Feature > Advantage > Benefit</h4>
  <p>1: HOOK (результат) > 2-7: 3 пары FAB > 8: SOCIAL PROOF > 9: OFFER > 10: CTA. Benefit всегда про пользователя.</p>
</div>

<div class="card">
  <span class="tag blue">Охваты</span>
  <h4>10. Провокация -- "Перестань делать X"</h4>
  <p>1: УДАР > 2: УТОЧНЕНИЕ > 3-7: АРГУМЕНТЫ (факты, нарастание) > 8: АЛЬТЕРНАТИВА > 9: ИТОГ > 10: CTA ("Согласна? Пиши"). Альтернатива обязательна.</p>
</div>

<div class="card">
  <span class="tag blue">Охваты</span>
  <h4>11. Cliff / Cliffhanger</h4>
  <p>1: HOOK (обрыв) > 2-8: CHAIN (каждый продолжает И обрывается) > 9: PAYOFF > 10: CTA. КАЖДЫЙ слайд обрывается. Без исключений.</p>
</div>

<div class="card">
  <span class="tag red">Продажи</span>
  <h4>12. Social Proof</h4>
  <p>1: CLAIM (цифра) > 2-4: TESTIMONIALS (имя + ниша + результат) > 5-6: DATA (до/после) > 7: AUTHORITY > 8: PATTERN > 9: YOUR TURN > 10: CTA.</p>
</div>

<div class="card">
  <span class="tag purple">Экспертность</span>
  <h4>13. Пирамида -- от простого к сложному</h4>
  <p>1: HOOK ("3 уровня. Большинство на первом") > 2-4: УРОВЕНЬ 1 > 5-7: УРОВЕНЬ 2 > 8-9: УРОВЕНЬ 3 (за пределами Google) > 10: CTA ("На каком ты?").</p>
</div>

<div class="card">
  <span class="tag orange">Запуски</span>
  <h4>14. Countdown -- Обратный отсчёт</h4>
  <p>1: HOOK > 2-3: 5-4 (разогрев) > 4-5: 3-2 (нарастание) > 6-7: 1 (самый мощный) > 8: REVEAL > 9: URGENCY > 10: CTA (с дедлайном).</p>
</div>

<div class="card">
  <span class="tag red">Продажи</span>
  <h4>15. Case Study -- Было > Сделали > Стало</h4>
  <p>1: HOOK (результат в цифрах) > 2: КТО > 3-4: БЫЛО (с цифрами) > 5-7: СДЕЛАЛИ > 8-9: СТАЛО (те же метрики) > 10: CTA.</p>
</div>

<div class="card">
  <span class="tag purple">Экспертность</span>
  <h4>16. Q&A / FAQ</h4>
  <p>1: HOOK ("7 вопросов, на которые устала отвечать") > 2-9: Q&A по одному на слайд > 10: CTA ("Какой не закрыла? Пиши").</p>
</div>

<hr>

<h2>Тарифы</h2>

<table>
  <tr><th></th><th>Free</th><th>Starter ($9-15/мес)</th><th>Pro ($29-49/мес)</th></tr>
  <tr><td><strong>Каруселей</strong></td><td>1 всего</td><td>12/мес (3/нед)</td><td>Безлимит</td></tr>
  <tr><td><strong>Визуал</strong></td><td>Standard (без текста)</td><td>Standard</td><td>Pro (текст на картинке)</td></tr>
  <tr><td><strong>Weekly Push</strong></td><td>Нет</td><td>Да</td><td>Да</td></tr>
  <tr><td><strong>Обратная связь 48ч</strong></td><td>Нет</td><td>Да</td><td>Да</td></tr>
  <tr><td><strong>Формулы</strong></td><td>3 (PAS, How-To, Контраст)</td><td>Все 16</td><td>Все 16</td></tr>
  <tr><td><strong>Невидимый критик</strong></td><td>Нет</td><td>Да</td><td>Да + отчёт</td></tr>
  <tr><td><strong>Подпись</strong></td><td>Нет</td><td>Да</td><td>Да</td></tr>
  <tr><td><strong>Style DNA</strong></td><td>Нет</td><td>Да</td><td>Да + стиль-донор</td></tr>
  <tr><td><strong>Batch (5 каруселей)</strong></td><td>Нет</td><td>Нет</td><td>Да</td></tr>
  <tr><td><strong>Streak</strong></td><td>Нет</td><td>Да</td><td>Да</td></tr>
  <tr><td><strong>Водяной знак</strong></td><td>Да</td><td>Нет</td><td>Нет</td></tr>
</table>

<div class="highlight">
<strong>Free = 1 карусель.</strong> Достаточно увидеть магию. Недостаточно пользоваться. Starter = основной тариф. Pro = готовые слайды с текстом.
</div>

<hr>

<h2>Стиль-донор (Pro)</h2>
<p>Пользователь кидает ссылку на чужой аккаунт. Бот "снимает" визуальный стиль: палитру, типографику, композицию.</p>

<div class="prompt-block">
  <div class="label">Промт: анализ визуального стиля донора</div>
  <code>You are an art director with 15 years of experience.

I'm uploading carousel images from a reference account.
Analyze the visual DNA. NOT content -- only visual language.

COLOR: Main palette (hex), Warm/cold, Contrast, Accent
LIGHT: Direction, Soft/hard, Shadow
COMPOSITION: Focal point, Symmetry, Negative space
TEXTURE: Smooth/grainy, Matte/glossy, Film effect
MOOD: Emotion, One word: ______

OUTPUT:
1. RECIPE FOR SERIES (copy to every new prompt)
2. ONE-LINE TAGS (comma-separated)
3. JSON for style_dna profile field

Not copying -- extracting visual language.</code>
</div>

<hr>

<h2>Tech stack: AIFromSpace</h2>

<table>
  <tr><th>Что</th><th>Инструмент</th><th>Заметки</th></tr>
  <tr><td>LLM (тексты, агенты 1-6)</td><td>CallLLMTool (OpenRouter)</td><td>7 вызовов на 1 карусель</td></tr>
  <tr><td>Профиль</td><td>ManageConstantMemoryTool</td><td>Per-user, навсегда</td></tr>
  <tr><td>Формулы + правила</td><td>ManageConstantMemoryTool</td><td>База знаний бота</td></tr>
  <tr><td>Критик-агент</td><td>AskAssistantTool</td><td>Отдельный ассистент</td></tr>
  <tr><td>Картинки</td><td>ImageGenTool</td><td>Nano Banana / Replicate</td></tr>
  <tr><td>Тренды (weekly push)</td><td>WebSearchTool (Perplexity)</td><td>Для v2</td></tr>
  <tr><td>Подписки</td><td>Stars + Tinkoff</td><td>Встроено</td></tr>
  <tr><td>Weekly Push</td><td>TaskTool (cron)</td><td>Вт 10:00, Чт 10:00</td></tr>
  <tr><td>Feedback 48ч</td><td>TaskTool (cron)</td><td>+48ч после генерации</td></tr>
  <tr><td>Style DNA (vision)</td><td>CallLLMTool (vision)</td><td>Анализ загруженных картинок</td></tr>
</table>

<hr>

<h2>Roadmap</h2>

<div class="card">
  <span class="tag red">MVP</span>
  <h4>Минимум для первых пользователей</h4>
  <p>Онбординг (4 вопроса, без Style DNA) > своя тема > 7 агентов (3 базовые формулы) > AI-картинки Standard.</p>
  <p><strong>Готово от меня:</strong> 3 формулы (PAS, Контраст, How-To) + все промты + платформенный интеллект + few-shot пример.</p>
  <p><strong>Нужно от тебя:</strong> бот на платформе, ImageGen, memory для профилей, pipeline 7 агентов.</p>
  <p><strong>Без:</strong> трендов, Pro-визуала, подписок, weekly push, Style DNA, стиль-донора.</p>
</div>

<h3>v1: монетизация</h3>
<ul style="padding-left: 20px; margin: 12px 0;">
  <li>Все 16 формул</li>
  <li>Подписки: Free / Starter / Pro</li>
  <li>Pro-визуал: картинки с текстом</li>
  <li>Подпись под карусель</li>
  <li>Style DNA в онбординге</li>
</ul>

<h3>v2: retention</h3>
<ul style="padding-left: 20px; margin: 12px 0;">
  <li>Weekly Push (cron)</li>
  <li>Обратная связь 48ч</li>
  <li>Streak + прогресс</li>
  <li>Тренды ниши (WebSearch)</li>
  <li>Стиль-донор (Pro)</li>
</ul>

<h3>v3: рост</h3>
<ul style="padding-left: 20px; margin: 12px 0;">
  <li>Batch: "5 каруселей на неделю"</li>
  <li>Контент-календарь</li>
  <li>Автосбор кейсов (после 10-й карусели)</li>
  <li>Реферальная программа</li>
</ul>

<hr>

<h2>Вопросы к тебе, Денис</h2>

<div class="card" style="border-color: #dc2626;">
  <span class="tag red">Критично для MVP</span>
  <h4>1. ImageGenTool + Nano Banana</h4>
  <p>Работает через Replicate/KieAI? Формат 1080x1350? Consistency между 10 слайдами?</p>
</div>

<div class="card" style="border-color: #dc2626;">
  <span class="tag red">Критично для MVP</span>
  <h4>2. Pipeline 7 агентов</h4>
  <p>AskAssistantTool -- можно цепочкой? Или лучше один ассистент с длинным промтом? Время ответа?</p>
</div>

<div class="card" style="border-color: #ea580c;">
  <span class="tag orange">Для v1</span>
  <h4>3. TaskTool (cron)</h4>
  <p>Поддерживает расписание? Вт 10:00 push + 48ч после генерации feedback. Возможности?</p>
</div>

<div class="card" style="border-color: #ea580c;">
  <span class="tag orange">Для v1</span>
  <h4>4. Vision для Style DNA</h4>
  <p>Пользователь загружает картинки. CallLLMTool с vision-моделью -- работает? Какая модель?</p>
</div>

<div class="card" style="border-color: #ea580c;">
  <span class="tag orange">Обсудить</span>
  <h4>5. Unit economics</h4>
  <p>7 LLM-вызовов + 5-10 картинок на карусель. Себестоимость? Определит финальные цены.</p>
</div>

<hr>

<h2>Диалог: как выглядит для пользователя</h2>

<div class="schema">
ПОЛЬЗОВАТЕЛЬ                          БОТ

/start
                                      "Привет! Я делаю Instagram-карусели
                                       по маркетинговым формулам.
                                       За 5 минут -- готовые картинки.

                                       Давай познакомимся (1 из 5).
                                       Как зовут? Чем занимаешься?"

"Маша, нутрициолог.
 Интуитивное питание."
                                      "(2 из 5) Кто твои клиенты?
                                       Что у них болит?"

"Женщины 30+, устали от диет,
 считают калории, срываются."
                                      "(3 из 5) Цель и стиль?"

                                       [Продажи] [Экспертность]
                                       [Охваты]  [Подписки]

            [Продажи]
                                       [Дерзко] [Тепло] [Экспертно]

            [Тепло]
                                      "(4 из 5) Визуальный стиль?"

                                       [Clean Light] [Bold Dark]
                                       [Magazine]    [Soft Pastel]

            [Soft Pastel]
                                      "(5 из 5) Скинь 1-3 картинки,
                                       которые нравятся по стилю."

         [фото]
                                      "Готово!
                                       Маша, нутрициолог
                                       ЦА: женщины 30+, диеты
                                       Стиль: тепло + пастель
                                       Верно?"

            [Да]
                                       "О чём карусель?"

"Читинг -- это не срыв"
                                      "Генерирую... 30 сек

                                       Готово!
                                       Формула: PAS
                                       (Боль > Усиление > Решение)

                                       [1] Ты не сорвалась. Ты поела.
                                       [2] Знакомое чувство?...
                                       ...
                                       [10] Воркшоп 'Еда без вины'

                                       [альбом 10 AI-картинок]
                                       + Подпись для поста

                                       [Скачать всё] [Поправить]"</div>

<h3>Повторный визит</h3>

<div class="schema">
                   ВТОРНИК, 10:00

                                      "Маша, 3 темы на этой неделе:

                                       1. Голод vs аппетит -- 4 маркера
                                       2. 5 продуктов, которые зря
                                          демонизируют
                                       3. Почему диеты не работают
                                          (цифры)

                                       Какая?"

            [1]
                                      "Генерирую...

                                       Формула: Скользкая горка

                                       [1] 4 сигнала тела,
                                           которые ты не слышишь...
                                       ...

                                       [Скачать всё] [Поправить]

                                       Карусель #2. Серия: 2 недели.
                                       2 из 16 формул."

                   ЧЕРЕЗ 48 ЧАСОВ

                                      "Маша, как карусель про голод?

                                       [50+ сохранений]
                                       [10-50]
                                       [Меньше 10]
                                       [Не постила]"</div>

<div class="footer">
  Carousel Bot -- техническая спецификация<br>
  Платформа AIFromSpace<br>
  Февраль 2026
</div>

</body>
</html>